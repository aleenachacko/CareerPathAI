<div class="container mt-4">
  <!-- Skill Gap Analysis Form -->
  <div class="card shadow">
    <div class="card-header bg-secondary text-white">
      <h4 class="mb-0">Skill Gap Analysis</h4>
    </div>

    <div class="card-body">
      <form [formGroup]="analysisForm" (ngSubmit)="$event.preventDefault()">
        <div class="row">
          <!-- Current Skills -->
          <div class="col-md-6 mb-4">
            <h5>Current Skills</h5>
            <div class="input-group mb-2">
              <input type="text" class="form-control" formControlName="newCurrentSkill" placeholder="Add current skill" />
              <button type="button" class="btn btn-outline-primary" (click)="addCurrentSkill()">Add</button>
            </div>
            <ul class="list-group">
              <li *ngFor="let skill of currentSkills; let i = index" class="list-group-item d-flex justify-content-between align-items-center">
                {{ skill }}
                <button type="button" class="btn btn-sm btn-outline-danger" (click)="removeCurrentSkill(i)">Remove</button>
              </li>
            </ul>
          </div>

          <!-- Desired Skills -->
          <div class="col-md-6 mb-4">
            <h5>Desired Skills</h5>
            <div class="input-group mb-2">
              <input type="text" class="form-control" formControlName="newDesiredSkill" placeholder="Add desired skill" />
              <button type="button" class="btn btn-outline-success" (click)="addDesiredSkill()">Add</button>
            </div>
            <ul class="list-group">
              <li *ngFor="let skill of desiredSkills; let i = index" class="list-group-item d-flex justify-content-between align-items-center">
                {{ skill }}
                <button type="button" class="btn btn-sm btn-outline-danger" (click)="removeDesiredSkill(i)">Remove</button>
              </li>
            </ul>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="d-flex gap-2 mt-3">
          <button type="button" class="btn btn-primary" (click)="analyzeSkills()" [disabled]="isLoading">Analyze Skills</button>
          <button type="button" class="btn btn-outline-secondary" (click)="saveAnalysis()" [disabled]="isLoading || !analysisResult">Save Analysis</button>
        </div>

        <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>
      </form>
    </div>
  </div>

  <!-- Analysis Result -->
  <div *ngIf="analysisResult?.analysis" class="card shadow mt-4">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Analysis Result</h5>
      <button class="btn btn-sm btn-outline-dark" (click)="showRaw = !showRaw">
        {{ showRaw ? 'Hide Raw JSON' : 'View Raw JSON' }}
      </button>
    </div>

    <div class="card-body">
      <!-- Summary -->
      <div *ngIf="analysisResult.analysis.summary">
        <h6 class="fw-bold text-primary">Summary</h6>
        <p class="text-muted">{{ analysisResult.analysis.summary }}</p>
      </div>

      <!-- Recommendations -->
      <div *ngIf="analysisResult.analysis.recommendations?.length">
        <h6 class="fw-bold text-success">Recommendations</h6>
        <ul class="list-group mb-3">
          <li *ngFor="let rec of analysisResult.analysis.recommendations" class="list-group-item">
            {{ rec }}
          </li>
        </ul>
      </div>

      <!-- Resources -->
      <div *ngIf="analysisResult.analysis.resources?.length">
        <h6 class="fw-bold text-secondary">Resources</h6>
        <ul class="list-group">
          <li *ngFor="let res of analysisResult.analysis.resources" class="list-group-item">
            {{ res }}
          </li>
        </ul>
      </div>

      <!-- Raw JSON View -->
      <pre *ngIf="showRaw" class="bg-dark text-white p-3 rounded mt-3">
{{ analysisResult | json }}
      </pre>
    </div>
  </div>
</div>